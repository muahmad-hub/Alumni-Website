{% extends "layout.html" %}
{% load static %}

{% block extra_css %}
    <link href="{% static 'mentorship/css/mentor_dashboard.css' %}" rel="stylesheet">
    <link rel="icon" href="/path/to/your/favicon.ico" type="image/x-icon">
{% endblock %}


{% block title %}
    Directory
{% endblock %}

{% block main %}

 <div class="container-fluid">
    <div class="row">

        <main class="container-fluid stats-card">
            <div class="d-flex justify-content-between align-items-center mt-4"  data-aos="fade-up" data-aos-duration="100">
                <h2>Welcome, {% if user.profile.first_name %}{{ user.profile.first_name }}{% if user.profile.last_name %} {{ user.profile.last_name }}{% endif %}{% endif %}!</h2>
            </div>

            <div class="row mt-4 g-3">
                <div class="col-md-4">
                    <div class="card card-summary text-center p-4"  data-aos="fade-up" data-aos-duration="100">
                        <h5>Total Requests</h5>
                        <h2>{{ all_requests_count }}</h2>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card card-summary text-center p-4" data-aos="fade-up" data-aos-duration="200">
                        <h5>Accepted Requests</h5>
                        <h2>{{ accepted_requests_count }}</h2>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card card-summary text-center p-4"  data-aos="fade-up" data-aos-duration="300">
                        <h5>Pending Requests</h5>
                        <h2>{{ declined_requests_count }}</h2>
                    </div>
                </div>
            </div>

            <div class="table-container mt-4"  data-aos="fade-up" data-aos-duration="400">
                <ul class="nav nav-tabs" id="requestTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="all-tab" data-bs-toggle="tab" data-bs-target="#all" type="button" role="tab">All Requests</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="accepted-tab" data-bs-toggle="tab" data-bs-target="#accepted" type="button" role="tab">Accepted</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="declined-tab" data-bs-toggle="tab" data-bs-target="#declined" type="button" role="tab">Declined</button>
                    </li>
                </ul>

                <div class="tab-content" id="requestTabsContent">
                    <!-- All Requests -->
                <div class="tab-pane fade show active" id="all" role="tabpanel">
                    <table class="table table-hover mt-3">
                        <thead>
                            <tr>
                                <th>Mentee Name</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for req in all_requests %}
                                <tr>
                                    <td>
                                        <a href="{% url 'view_profile' req.mentee.id %}" class="view-profile-link">
                                            {% if req.mentee.profile.first_name or req.mentee.profile.last_name %}
                                                {% if req.mentee.profile.first_name %}
                                                    {{ req.mentee.profile.first_name }}
                                                    {% if req.mentee.profile.last_name %}
                                                        {{ req.mentee.profile.last_name }}
                                                    {% endif %}
                                                {% else %}
                                                    {{ req.mentee.profile.last_name }}
                                                {% endif %}
                                            {% else %}
                                                No name
                                            {% endif %}
                                        </a>
                                    </td>
                                    <td>{{ req.created_at|date:"F j, Y" }}</td>
                                    <td>
                                        {% if req.accept == None %}
                                            <span class="status-pending">Pending</span>
                                        {% elif req.accept == True %}
                                            <span class="status-accepted">Accepted</span>
                                        {% elif req.accept == False %}
                                            <span class="status-declined">Declined</span>
                                        {% else %}
                                            <span class="status-unknown">Unknown</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if req.accept == None %}
                                            <a href="{% url 'accept_mentor' req.id req.mentor.user.id %}" class="text-success me-3">Accept</a>
                                            <a href="{% url 'decline_mentor' req.id req.mentor.user.id %}" class="text-danger">Decline</a>
                                        {% elif req.accept == True %}
                                            <span class="text-muted">Already Accepted</span>
                                        {% elif req.accept == False %}
                                            <span class="text-muted">Already Declined</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>


                    <!-- Accepted Requests -->
                    <div class="tab-pane fade" id="accepted" role="tabpanel">
                        <table class="table table-hover mt-3">
                            <thead>
                                <tr>
                                    <th>Mentee Name</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for req in accepted_requests %}
                                    <tr>
                                        <td>
                                            <a href="{% url 'view_profile' req.mentee.id %}" class="view-profile-link">
                                                {% if req.mentee.profile.first_name or req.mentee.profile.last_name %}
                                                    {% if req.mentee.profile.first_name %}{{ req.mentee.profile.first_name }}{% if req.mentee.profile.last_name %} {{ req.mentee.profile.last_name }}{% endif %}{% endif %}
                                                {% else %}
                                                    No name
                                                {% endif %}
                                            </a>
                                        </td>
                                        <td>{{ req.created_at|date:"F j, Y" }}</td>
                                        <td><span class="status-accepted">Accepted</span></td>
                                        <td>
                                            <a href="{% url 'decline_mentor' req.id req.mentor.user.id %}" class="text-danger">Decline</a>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    <!-- Declined Requests -->
                    <div class="tab-pane fade" id="declined" role="tabpanel">
                        <table class="table table-hover mt-3">
                            <thead>
                                <tr>
                                    <th>Mentee Name</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for req in declined_requests %}
                                    <tr>
                                        <td>
                                            <a href="{% url 'view_profile' req.mentee.id %}" class="view-profile-link">
                                                {% if req.mentee.profile.first_name or req.mentee.profile.last_name %}
                                                    {% if req.mentee.profile.first_name %}{{ req.mentee.profile.first_name }}{% if req.mentee.profile.last_name %} {{ req.mentee.profile.last_name }}{% endif %}{% endif %}
                                                {% else %}
                                                    No name
                                                {% endif %}
                                            </a>
                                        </td>
                                        <td>{{ req.created_at|date:"F j, Y" }}</td>
                                        <td><span class="status-declined">Declined</span></td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
                </div>
            </div>
        </main>
    </div>
</div>

{% endblock %} 