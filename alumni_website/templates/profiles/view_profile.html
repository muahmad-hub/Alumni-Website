{% extends "layout.html" %}
{% load static %}

{% block extra_css %}
    <link href="{% static 'profiles/css/profile.css' %}" rel="stylesheet">
    <link rel="icon" href="/path/to/your/favicon.ico" type="image/x-icon">
{% endblock %}


{% block title %}
    User Profile
{% endblock %}

{% block main %}

<div class="profile-container" data-aos="fade-up">


    <div class="alert alert-primary" id="connect_message">
    <!-- TODO Link to user's messaging chat -->
    Once {{ profile.last_name }} accepts the request, you can chat with them <a href="#" class="alert-link">here</a>
    </div>

    <div class="alert alert-primary" id="mentor_message">
    <!-- TODO Link to user's messaging chat -->
    Once {{ profile.last_name }} accepts the mentor request, you can take guidance from them through the chat <a href="#" class="alert-link">here</a>
    </div>


<div class="profile-header d-flex justify-content-between align-items-center gap-3 mb-4">
  <div class="d-flex align-items-center gap-3">
    <img src="{% if profile.profile_url %}{{ profile.profile_url }}{% else %}{% static 'images/profile_image.jpg' %}{% endif %}" alt="Profile" class="avatar">
    <div class="profile-info">
      <h2 class="mb-1">
        {% if profile.first_name %}{{ profile.first_name }}{% if profile.last_name %} {{ profile.last_name }}{% endif %}{% endif %}
      </h2>
      {% if profile.user.is_superuser %}
        <p class="text-muted mb-0 admin">Admin</p>
      {% endif %}
      <p class="text-muted mb-0">
        {% if profile.location %}{{ profile.location }}{% endif %}
      </p>
      <p class="text-muted mb-0">
        {% if profile.has_job %}
          {{ profile.role }} at {{ profile.employer }}
        {% else %}
          {{ profile.university }} at {{ profile.major_uni }}
        {% endif %}
      </p>
    </div>
  </div>


  <div class="d-flex gap-2 connection_buttons">
    <form method="POST">
    {% csrf_token %}
    {% csrf_token %}
    {% if profile.user != user %}
    <button class="btn connect btn-sm">
        {% if connection is None %}
            Connect
        {% elif connection.accepted == True %}
            Connected
        {% else %}
            Pending
        {% endif %}
    </button>
    {% if mentor_exists %}
    <button class="btn request_mentor btn-sm">
      {% if mentor_match is None %}
        Request mentor
      {% elif mentor_match.accepted == True %}
        Mentor Connected
      {% else %}
        Mentor Request Sent
      {% endif %}
    </button>
    {% endif %}
    {% endif %}
    </form>
  </div>
</div>



  <div class="section" data-aos="fade-up" data-aos-delay="100">
    <div class="section-header d-flex justify-content-between align-items-center mb-3">
      <h3>Personal Information</h3>
    </div>
    <div class="row g-3">

      <div class="col-md-6">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">First name</div>
            <div class="fs-6">
                {% if profile.first_name %}
                    {{ profile.first_name }}
                {% else %}
                    No first name added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">Last Name</div>
            <div class="fs-6">
                {% if profile.last_name %}
                    {{ profile.last_name }}
                {% else %}
                    No last name added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">Date of Birth</div>
            <div class="fs-6">
                {% if profile.date_of_birth %}
                    {{ profile.date_of_birth }}
                {% else %}
                    No Date of Birth added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">Email Address</div>
            <div class="fs-6">
                {% if profile.user.email %}
                    {{ profile.user.email }}
                {% else %}
                    No email adress added yet 
                {% endif %}
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="section" data-aos="fade-up" data-aos-delay="100">
    <div class="section-header d-flex justify-content-between align-items-center mb-3">
      <h3>Bio Section</h3>
    </div>
    <div class="row g-3">
      <div class="col-md-12">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">About Me</div>
            <div class="fs-6">
                {% if profile.about_me %}
                    {{ profile.about_me }}
                {% else %}
                    No Bio added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="section" data-aos="fade-up" data-aos-delay="100">
    <div class="section-header d-flex justify-content-between align-items-center mb-3">
      <h3>Education</h3>
    </div>
    <div class="row g-3">

      <div class="col-md-6">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">Graduation Year</div>
            <div class="fs-6">
                {% if profile.graduation_year %}
                    {{ profile.graduation_year }}
                {% else %}
                    No graduation year added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">Education Level</div>
            <div class="fs-6">
                {% if profile.education_level %}
                    {{ profile.education_level }}
                {% else %}
                    No Education level added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">University</div>
            <div class="fs-6">
                {% if profile.university %}
                    {{ profile.university }}
                {% else %}
                    No University added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">University Location</div>
            <div class="fs-6">
                {% if profile.university_location %}
                    {{ profile.university_location }}
                {% else %}
                    No university location added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">University Major</div>
            <div class="fs-6">
                {% if profile.major_uni %}
                    {{ profile.major_uni }}
                {% else %}
                    No university major added yet
                {% endif %}
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="section" data-aos="fade-up" data-aos-delay="100">
    <div class="section-header d-flex justify-content-between align-items-center mb-3">
      <h3>Skills</h3>
    </div>
    <div class="row g-3">
      {% for skill in profile.skills.all %}
      <div class="col-md-4">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="fs-6">
              {{ skill.skill }}
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="col-md-4">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="fs-6">
              No skills added yet
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>



{% if profile.has_job and profile.employer and profile.role %}
  <div class="section" data-aos="fade-up" data-aos-delay="100">
    <div class="section-header d-flex justify-content-between align-items-center mb-3">
      <h3>Career</h3>
    </div>
    <div id="job_section">
    <div class="row g-3">
      <div class="col-md-6">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">Role</div>
            <div class="fs-6">
              {% if profile.role %}
              {{ profile.role }}
              {% else %}
              No role added yet
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="profile-information">
          <div class="bg-light p-3 rounded">
            <div class="text-muted small fw-semibold">Employer</div>
            <div class="fs-6">
              {% if profile.employer %}
              {{ profile.employer }}
              {% else %}
                No employer added yet
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>
  </div>
</div>
{% endif %}

  <script>
    AOS.init({
      duration: 700,
      once: true,
    });

    var csrfToken = `{{ csrf_token }}`
    var profile_id = `{{ profile.id }}`
    var connect = `{% url 'connect' %}`

    var mentor_match = `{% url 'mentor_match' %}`
    var id = `{{ profile.user.id }}`
  </script>

 <script src="{% static 'profiles/javascript/connections.js' %}"></script>

  {% endblock %}
